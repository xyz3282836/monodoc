---
title: "指数移动加权平均法"
date: 2023-07-04 22:22:00 +8
category: algorithm
tag:
  - ewma
  - average
---

`EWMA (Exponentially Weighted Moving-Average)` 指数移动加权平均法: 是指各数值的加权系数随时间呈指数递减，越靠近当前时刻的数值加权系数就越大，体现了最近一段时间内的平均值。

- 公式： $V_t=\beta*V_{t-1}+(1-\beta)\theta_t$

- 变量解释：

- - $V_t$：代表的是第 `t` 次请求的 `EWMA值`
  - $V_{t-1}$：代表的是第 `t-1` 次请求的 `EWMA值`
  - $\beta$：是一个常量
  - $\theta_t$：是当前实时值
- $V_t$约等于最近$\frac{1}{1-\beta}$范围内的实时值的均值，比如$\beta=0.9$，那么$V_t$约等于$\theta_{t-10}$，...，$\theta_{t}$的平均值
  - $\beta$越大，EWMA 值$V_t$就越接近平均值，极限情况上述就是所有实时值的平均值
  - $\beta$越小，EWMA 值$V_t$就越接近$\theta_t$，极限情况上述就是$\theta_t$

### **EWMA 算法的优势**

1. 相较于普通的计算平均值算法，`EWMA` 不需要保存过去所有的数值，计算量显著减少，同时也减小了存储资源。
2. 传统的计算平均值算法对网络耗时不敏感, 而 `EWMA` 可以通过请求频繁来调节 `β`，进而迅速监控到网络毛刺或更多的体现整体平均值。

- 当请求较为频繁时, 说明节点网络负载升高了, 我们想监测到此时节点处理请求的耗时(侧面反映了节点的负载情况), 我们就相应的调小`β`。`β`越小，`EWMA值` 就越接近本次耗时，进而迅速监测到网络毛刺;
- 当请求较为不频繁时, 我们就相对的调大`β值`。这样计算出来的 `EWMA值` 越接近平均值

$ \text{综合活跃指标} = 0.8 \times \frac{\sum*{i=1}^{4} \text{指标权重}\_i \times \left(\frac{\text{实际部分1的指标数}}{4} \times \frac{\text{实际部分1的指标值}\_i}{\text{指标最大值}\_i}\right)}{4} + 0.2 \times \frac{\sum*{j=5}^{10} \text{指标权重}\_j \times \left(\frac{\text{实际部分2的指标数}}{6} \times \frac{\text{实际部分2的指标值}\_j}{\text{指标最大值}\_j}\right)}{6} $
