---
title: "系统架构揭秘--构建安全可靠的系统"
date: 2023-06-14 13:07:00 +8
category: architecture
tag:
  - secure
  - reliable
---

## 安全性与可靠性的交集

### 设计注意事项

可靠性与安全性的权衡：冗余和事件管理

### 机密性，完整性，可用性

传统定义中，安全系统的基本属性包含机密性（confidentiality），完整性（integrity），可用性（availability），CIA 三要素

可用性，既关乎可用性，有关乎安全性。比较经典的 DDoS（distributed denial-of-service）分布式拒绝服务

### 共性

可靠性和安全性是系统设计中比较突出的属性，并且很难事后再加固，所以设计之初就需要考虑这两个属性，系统变更的过程中，很容易影响这两点，因此需要整个系统生命周期持续关注和测试它们。

#### 隐形

没有紧急情况下，这两者的隐形意味着可以减少和推迟也不会立刻造成严重后果，一旦失效就会带来很严重的后果。

#### 评估

根据所需要的错误预算（sre google 运维揭秘第三章）来计划工程工作，至少一部分是可以这样做的。攻防演练也可以评估。

#### 简洁性

可以帮助提高评估能力，是最佳方法之一。见第 6 章。

#### 演变

随着业务迭代发展，不可避免让系统变得复杂，从而积累技术债务。微小变更导致重大故障。（debian 和 youtube 的案例）

#### 弹性

系统设计应该包含冗余和不同的故障域，从而通过重新路由请求来限制降低故障的影响。第 8 章深入这点。第 10 章深入探讨 DoS 缓解措施。

每个组件的弹性有上限，可以通过纵深防御和故障域来解决。前者是多种防御机制的集合（冗余也是一种），独立故障域是限制故障的爆炸半径。

划分权限和限制凭证的可用范围来实现不同故障域。

最新特权原则可用缓解内部威胁。

google 是使用多方授权来确保敏感操作由特定员工组审批。

#### 从设计到生产

从代码阶段开始，通过代码审阅来发现潜在问题，甚至公共框架和库来防止。第 12 章深入探讨。

实际部署代码的方法也可以控制安全性和可靠性的风险。第 14 章说明。

#### 调查系统和日志

需要制定计划来检测故障并从故障中恢复。

完善的日志记录是检测和防备故障的基础。第 15 章详述日志。日志越完整详细越好，但是也有注意事项，足够大的规模，大量日志带来很大成本，给分析日志带来困难。youtube 的案例说明日志也会带来可靠性的问题，还有安全问题，日志不应该包含认证凭证和个人身份信息等敏感信息。

#### 危机响应

组织响应非常有挑战性，需要提前制定响应计划。

大的组织，需要 24 小时响应或者跨时区协作。安全事件存在矛盾，多方参与和限制信息传递。

危机期间，需要清晰的指挥链和坚实的检查清单，行动手册和协议。

google 已经转化为事件管理（Incident Management at Google，IMAG）来处理危机响应，并且定期使用灾难恢复测试系统（Disaster Recovery Testing program，DiRT）来模拟各种故障来迫使团队应用这些。第 16，17 章说明。

#### 恢复

快速推送变更是把双刃剑，最终归结为风险评估和业务决策。

第 9 章和第 18 章讨论。

#### 小结

安全性和可靠性，最初很容易成为换取更快速度的代价，事后需要高昂的修复成本，所以需要尽早解决。

组织必须了解安全性和可靠性文化，第 21 章，涉及的角色和责任，见第 20 章。
